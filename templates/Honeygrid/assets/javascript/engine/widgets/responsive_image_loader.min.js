"use strict";gambio.widgets.module("responsive_image_loader",[gambio.source+"/libs/events",gambio.source+"/libs/responsive"],function(t){var a=$(this),e={breakpoints:["xs","sm","md","lg"]},i=$.extend(!0,{},e,t),n={},o=function(){void 0===$.expr.pseudos.attr&&($.expr.pseudos.attr=$.expr.createPseudo(function(t){var a=new RegExp(t);return function(t){for(var e=0;e<t.attributes.length;e++){var i=t.attributes[e];if(a.test(i.name))return!0}return!1}}))},r=function(t){var a=$(this),e=(jse.libs.template.responsive.breakpoint(),t&&t.length?t:a.filter(":attr(^data-image)").add(a.find(":attr(^data-image)")));e.not(".lazyLoading").each(function(){var t=$(this),a=jse.libs.template.responsive.breakpoint(),e=i.breakpoints.indexOf(a.name),n=i.breakpoints.length,o=null;for(e;e<n;e+=1){var r="data-image-"+i.breakpoints[e],s=t.attr(r);if(s){o=s;break}}o||(o=t.attr("data-image")),o&&t.attr("src")!==o&&t.attr("src",o)})},s=function(){var t=a.filter(".lazyLoading:attr(^data-image)").add(a.find(".lazyLoading:attr(^data-image)")),e=function(){var a=$(window).width(),e=$(window).height(),i=$(window).scrollTop(),n=$(window).scrollLeft();t.each(function(){var o=$(this),r=o.offset();(r.top<i+e||r.left<n+a)&&(t=t.not(o),o.trigger("lazyLoadImage"))})},i=function(t){t.stopPropagation();var a=$(this);a.removeClass("lazyLoading"),r(a)};t.each(function(){$(this).one("lazyLoadImage",i)}),$(window).on("scroll windowWasResized",e),e()};return n.init=function(t){o(),s(),$(window).on(jse.libs.template.events.BREAKPOINT(),function(){r.call(a)}),r.call(a),t()},n});