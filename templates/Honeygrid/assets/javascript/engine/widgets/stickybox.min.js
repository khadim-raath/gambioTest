"use strict";gambio.widgets.module("stickybox",[gambio.source+"/libs/events",gambio.source+"/libs/responsive"],function(t){var e=$(this),o=$(window),s=null,n=null,i=null,r=null,l=null,p=null,a=null,u=null,c=null,f=null,m=null,g=null,b=null,d=null,h=null,x=null,v=null,T=0,k=!0,w=null,B={breakpoint:60,outerWrapper:"#outer-wrapper",header:"header",footer:".product-info-listings, footer",offsetTopReferenceSelector:"#breadcrumb_navi, .product-info",marginTop:15,marginBottom:0,zIndex:1e3,cpuOptimization:!1,smoothness:10,smoothnessDelay:150,stage:"#stage",errorBox:"table.box-error, table.box-warning"},I=$.extend(!0,{},B,t),y={},z=function(){l=s.outerHeight(),r=n.offset().top,l+=I.marginTop,r-=I.marginBottom,p=e.outerHeight(),a=e.outerWidth(),u=u||e.offset(),f=$(document).height();var t=I.marginTop;m&&(t=l),g={position:"fixed",top:t+"px",left:u.left+"px","z-index":I.zIndex,width:a}},j=function(){return k&&(k=!1,F(),window.setTimeout(function(){k=!0},100),w=f-Math.abs(r-f)-l),w>p},H=function(t){var o=h-(x-l)+t;if(m){var s=t+l+p+I.marginBottom,n=s-r,i=parseFloat(e.css("top"));o=o<h?h:o,o-=n-l,l+t<=u.top?F():n>0?r-t<p+x-h?(o=r-p-x+h-v,F(),e.css({top:o+"px"})):Math.abs(i-o)>=.5&&(F(),e.css({top:o+"px"})):"fixed"===e.css("position")&&e.css("top")===g.top||e.css(g)}else t<=u.top-I.marginTop?F():r-t+I.marginTop<p-h-I.marginTop?(o=r-p-x+h-v,F(),e.css({top:o+"px"})):"fixed"===e.css("position")&&e.css("top")===g.top||e.css(g)},O=function(){return T+=1,clearTimeout(b),T<I.smoothness?(b=setTimeout(function(){o.trigger("scroll.stickybox",!0)},I.smoothnessDelay),!1):(T=0,!0)},S=function(){var t=e.offset().top,o=$(I.offsetTopReferenceSelector).first().offset().top,s=t-o,n=parseFloat(e.css("top"));c=n-s,F()},F=function(){e.removeAttr("style"),"md"!==jse.libs.template.responsive.breakpoint().name&&"lg"!==jse.libs.template.responsive.breakpoint().name||e.css("top",c+"px")},R=function(t,e){if(I.cpuOptimization&&!e&&!O())return!0;if(jse.libs.template.responsive.breakpoint().id>I.breakpoint){z();var s=o.scrollTop(),n=j();n&&H(s)}},W=function(){F(),u=null,T=0,d=e.offset().top,R()};return y.init=function(t){var r=0,l=0,p=0,a=0;i=$(I.outerWrapper),s=$(I.header),n=$(I.footer),$(I.stage).length>0&&(r=$(I.stage).outerHeight()),$(I.errorBox).each(function(){p=parseInt($(this).css("margin-top"),10),a=parseInt($(this).css("margin-bottom"),10),l+=$(this).outerHeight(),l+=p,l+=a});var u=$(I.errorBox).length;return u>=2&&(l-=p*(u-1)),S(),d=e.offset().top,h=parseFloat(e.css("top")),x=s.outerHeight()+I.marginTop+r+l,v=parseFloat(i.css("margin-top").replace(/[^\d]/,"")),m="fixed"===s.css("position"),jse.core.config.get("mobile")?t():(R(),o.on("resize",W).on("scroll.stickybox",R).on(jse.libs.template.events.REPOSITIONS_STICKYBOX(),W),void t())},y});