"use strict";gambio.widgets.module("checkbox",[],function(e){var s=$(this),a={filter:"",on_url:"",off_url:"",on_label:"",off_label:"",on_text:"",off_text:"","class":"",checked:!1},t=!1,c=$.extend(!0,{},a,e),i={},o=function(e){if($(this).hasClass("disabled"))return!1;var s=$(this),a=s.find("input:checkbox"),t=s.find("input:radio").first(),i=s.find("input:radio").last(),o=s.find("select").first();s.parent().data("checkbox");s.toggleClass("checked"),s.find(".state-description").show().fadeOut("slow"),a.prop("checked",s.hasClass("checked")),t.prop("checked",s.hasClass("checked")),i.prop("checked",!s.hasClass("checked")),o.find("option").removeAttr("selected");var n=s.hasClass("checked")?1:0;if(o.find('option[value="'+n+'"]').attr("selected",!0),""!==c.on_url&&""!==c.off_url){if(e.preventDefault(),e.stopPropagation(),c.checked)return window.location.href=c.off_url,c.checked=!1,!1;window.location.href=c.on_url,c.checked=!0}},n=function(e){return!$(this).hasClass("disabled")&&(t=!0,void $(this).find("input:checkbox").focus())},d=function(e){return!$(this).hasClass("disabled")&&($(this).toggleClass("checked"),$(this).find("input:checkbox").focus(),void(t=!1))},l=function(e){var a=e||s;a.find("input:checkbox").filter(c.filter||"*").each(function(){var e=$(this),s=e.parseModuleData("checkbox"),a=s.className||"",i=e.prop("title"),o=e.prop("checked")?"checked":"",n=e.prop("disabled")?"disabled":"";if("undefined"!=typeof e.data("single_checkbox")){e.css({position:"absolute",left:"-100000px"}).wrap('<span class="single-checkbox '+o+" "+n+'" title="'+i+'"></span>');var d=void 0!==c.useGlyphicons?"glyphicon glyphicon-ok":"fa fa-check";e.parent().append('<i class="'+d+'"></i>'),e.on("focus",function(){$(".single_checkbox").removeClass("focused"),$(this).parent().addClass("focused")}),e.on("blur",function(){$(this).parent().removeClass("focused")}),e.on("change",function(){t===!1&&$(this).parent().toggleClass("checked")})}else{var l=e.attr("data-checkbox-on_text")?e.attr("data-checkbox-on_text"):'<span class="fa fa-check"></span>',f=e.attr("data-checkbox-on_text")?e.attr("data-checkbox-off_text"):'<span class="fa fa-times"></span>';e.wrap('<div class="switcher '+o+" "+n+'" title="'+i+'"></div>').parent().data("checkbox",s).addClass(a).append('<div class="switcher-toggler"></div><div class="switcher-inner"><div class="switcher-state-on">'+l+'</div><div class="switcher-state-off">'+f+'</div></div><div class="switcher-text-on">'+c.on_text+'</div><div class="switcher-text-off">'+c.off_text+"</div>")}})},f=function(){if(2===s.find("input:radio").filter(c.filter||"*").length){var e=s.find("input:radio").filter(c.filter||"*").first(),a=e.prop("title"),t=s.find("input:radio").filter(c.filter||"*").last(),i=t.prop("title"),o=""!==c.on_label?' data-checkbox-label="'+c.on_label+'"':"",n=""!==c.off_label?' data-checkbox-label="'+c.off_label+'"':"",d=c,l=e.prop("checked")?"checked":"",f=e.prop("disabled")?"disabled":"",r=$('<div class="switcher '+l+" "+f+'"></div>');e.after(r),e.appendTo(r),t.appendTo(r),r.data("checkbox",d).addClass(c["class"]).append('<div class="switcher-toggler"></div><div class="switcher-inner"><div class="switcher-state-on" title="'+a+'"'+o+'><span class="fa fa-check"></span></div><div class="switcher-state-off" title="'+i+'"'+n+'><span class="fa fa-times"></span></div><div class="switcher-text-on">'+c.on_text+'</div><div class="switcher-text-off">'+c.off_text+"</div></div>"),e.on("change",function(){$(this).parent().toggleClass("checked")}),t.on("change",function(){$(this).parent().toggleClass("checked")})}},r=function(){if(""!==c.on_url&&""!==c.off_url){var e=s.parseModuleData("checkbox"),a=""!==c.on_label?' data-checkbox-label="'+c.on_label+'"':"",t=""!==c.off_label?' data-checkbox-label="'+c.off_label+'"':"",i=c.checked?"checked":"";s.data("checkbox",e).addClass("switcher").addClass(i).addClass(c["class"]).append('<div class="switcher-toggler"></div><div class="switcher-inner"><div class="switcher-state-on" title="'+c.off_url+'"'+a+'><span class="fa fa-check"></span></div><div class="switcher-state-off" title="'+c.on_url+'"'+t+'><span class="fa fa-times"></span></div></div>').on("click",o)}},h=function(){s.on("click",".switcher",o),s.off("mousedown",".single-checkbox"),s.on("mousedown",".single-checkbox",n),s.off("mouseup",".single-checkbox"),s.on("mouseup",".single-checkbox",d),s.on("mousedown","label",function(){t=!0}),s.on("mouseup","label",function(){t=!1}),s.on("FORM_UPDATE",function(e){var s=$(e.target);s.find("input:checkbox").each(function(){var e=$(this),s=e.closest(".switcher");s.length&&(s.find("div").remove(),e.unwrap())}),l(s)})},p=function(){s.find("[data-convert-checkbox]").each(function(e,s){var a=$(s).find('option[value="1"]'),t=($(s).find('option[value="0"]'),a.is(":selected")?"checked":""),i=$(s).is(":disabled")?"disabled":"",o=$('<div class="switcher '+t+" "+i+'"></div>');o.addClass($(s).data("newClass")).data("checkbox",c).append('<div class="switcher-toggler"></div><div class="switcher-inner"><div class="switcher-state-on"><span class="fa fa-check"></span></div><div class="switcher-state-off"><span class="fa fa-times"></span></div></div>'),$(s).after(o).appendTo(o).hide()})};return i.init=function(e){l(),f(),p(),r(),h(),e()},i});