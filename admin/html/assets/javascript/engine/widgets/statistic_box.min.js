"use strict";gx.widgets.module("statistic_box",["loading_spinner"],function(t){var e=$(this),a=e.find("[data-statistic_box-item]"),s=$(".js-interval-dropdown"),n={item:"online",icon:"fa-dashboard",color:"gray",ordersUrl:"admin.php?do=OrdersOverview"},r=$.extend(!0,{},n,t),o={},d=new Date,i=d.getDate(),l=d.getMonth()+1,p=d.getFullYear(),c=new Date(d.getFullYear(),d.getMonth(),d.getDate()-7),_=c.getDate(),g=c.getMonth()+1,h=c.getFullYear(),m=new Date(d.getFullYear(),d.getMonth(),d.getDate()-14),T=m.getDate(),x=m.getMonth()+1,w=m.getFullYear(),D=new Date(d.getFullYear(),d.getMonth()-1,d.getDate()),u=D.getDate(),S=D.getMonth()+1,f=D.getFullYear(),Y=new Date(d.getFullYear(),d.getMonth()-3,d.getDate()),I=Y.getDate(),C=Y.getMonth()+1,M=Y.getFullYear(),b=new Date(d.getFullYear(),d.getMonth()-6,d.getDate()),A=b.getDate(),y=b.getMonth()+1,k=b.getFullYear(),v=new Date(d.getFullYear()-1,d.getMonth(),d.getDate()),O=v.getDate(),E=v.getMonth()+1,R=v.getFullYear(),j={sales:{apiUrl:"admin.php?do=Dashboard/GetSales",heading:"%timespan%",subtext:jse.core.lang.translate("STATISTICS_SALES","start"),smallText:"("+jse.core.lang.translate("STATISTICS_INTERVAL_TODAY","start")+": %today%)",onClick:function(){switch(s.find("option:selected").val()){case"week":window.open("stats_sales_report.php?report=4&startD="+_+"&startM="+g+"&startY="+h+"&detail=0&max=0&payment=0&export=0&sort=4&endD="+i+"&endM="+l+"&endY="+p,"_self");break;case"two_weeks":window.open("stats_sales_report.php?report=3&startD="+T+"&startM="+x+"&startY="+w+"&detail=0&max=0&payment=0&export=0&sort=4&endD="+i+"&endM="+l+"&endY="+p,"_self");break;case"month":window.open("stats_sales_report.php?report=3&startD="+u+"&startM="+S+"&startY="+f+"&detail=0&max=0&payment=0&export=0&sort=4&endD="+i+"&endM="+l+"&endY="+p,"_self");break;case"three_months":window.open("stats_sales_report.php?report=2&startD="+I+"&startM="+C+"&startY="+M+"&detail=0&max=0&payment=0&export=0&sort=4&endD="+i+"&endM="+l+"&endY="+p,"_self");break;case"six_months":window.open("stats_sales_report.php?report=2&startD="+A+"&startM="+y+"&startY="+k+"&detail=0&max=0&payment=0&export=0&sort=4&endD="+i+"&endM="+l+"&endY="+p,"_self");break;case"year":window.open("stats_sales_report.php?report=2&startD="+O+"&startM="+E+"&startY="+R+"&detail=0&max=0&payment=0&export=0&sort=4&endD="+i+"&endM="+l+"&endY="+p,"_self")}}},online:{apiUrl:"admin.php?do=Dashboard/GetUsersOnline",heading:"%timespan%",subtext:jse.core.lang.translate("STATISTICS_USERS_ONLINE","start"),smallText:"",onClick:function(){window.open("whos_online.php","_self")}},visitors:{apiUrl:"admin.php?do=Dashboard/GetVisitors",heading:"%timespan%",subtext:jse.core.lang.translate("STATISTICS_VISITORS","start"),smallText:"("+jse.core.lang.translate("STATISTICS_INTERVAL_TODAY","start")+": %today%)",onClick:function(){window.open("gm_counter.php","_self")}},newCustomers:{apiUrl:"admin.php?do=Dashboard/GetNewCustomers",heading:"%timespan%",subtext:jse.core.lang.translate("STATISTICS_NEW_CUSTOMERS","start"),smallText:"("+jse.core.lang.translate("STATISTICS_INTERVAL_TODAY","start")+": %today%)",onClick:function(){window.open("customers.php","_self")}},orders:{apiUrl:"admin.php?do=Dashboard/GetOrdersCount",heading:"%timespan%",subtext:jse.core.lang.translate("STATISTICS_ORDERS_COUNT","start"),smallText:"("+jse.core.lang.translate("STATISTICS_INTERVAL_TODAY","start")+": %today%)",onClick:function(){window.open(r.ordersUrl,"_self")}},conversionRate:{apiUrl:"admin.php?do=Dashboard/GetConversionRate",heading:"%timespan% %",subtext:jse.core.lang.translate("STATISTICS_CONVERSION_RATE","start"),smallText:"("+jse.core.lang.translate("STATISTICS_INTERVAL_TODAY","start")+": %today% %)",onClick:function(){window.open("gm_counter.php","_self")}},avgOrderTotal:{apiUrl:"admin.php?do=Dashboard/GetAverageOrderValue",heading:"%timespan%",subtext:jse.core.lang.translate("STATISTICS_AVERGAGE_ORDER_VALUE","start"),smallText:"("+jse.core.lang.translate("STATISTICS_INTERVAL_TODAY","start")+": %today%)",onClick:function(){switch(s.find("option:selected").val()){case"week":window.open("stats_sales_report.php?report=4&startD="+_+"&startM="+g+"&startY="+h+"&detail=2&max=0&payment=0&export=0&sort=4&endD="+i+"&endM="+l+"&endY="+p,"_self");break;case"two_weeks":window.open("stats_sales_report.php?report=3&startD="+T+"&startM="+x+"&startY="+w+"&detail=2&max=0&payment=0&export=0&sort=4&endD="+i+"&endM="+l+"&endY="+p,"_self");break;case"month":window.open("stats_sales_report.php?report=3&startD="+u+"&startM="+S+"&startY="+f+"&detail=2&max=0&payment=0&export=0&sort=4&endD="+i+"&endM="+l+"&endY="+p,"_self");break;case"three_months":window.open("stats_sales_report.php?report=2&startD="+I+"&startM="+C+"&startY="+M+"&detail=2&max=0&payment=0&export=0&sort=4&endD="+i+"&endM="+l+"&endY="+p,"_self");break;case"six_months":window.open("stats_sales_report.php?report=2&startD="+A+"&startM="+y+"&startY="+k+"&detail=2&max=0&payment=0&export=0&sort=4&endD="+i+"&endM="+l+"&endY="+p,"_self");break;case"year":window.open("stats_sales_report.php?report=2&startD="+O+"&startM="+E+"&startY="+R+"&detail=2&max=0&payment=0&export=0&sort=4&endD="+i+"&endM="+l+"&endY="+p,"_self")}}}},F={today:"%today%",timespan:"%timespan%"},U=function(t,e){for(var a in F)F.hasOwnProperty(a)&&(t=t.replace(F[a],e[a]));return t},N=function(t){$.ajax({url:"admin.php?do=Dashboard/GetStatisticBoxes&interval="+t,type:"GET",dataType:"json"}).done(function(t){for(var a in t){var s=t[a],n=e.find('[data-statistic_box-item="'+a+'"]'),r=n.find(".heading"),o=n.find(".subtext"),d=n.find(".small-text"),i={timespan:s.timespan,today:s.today};n.find(".icon-container, .text-container").animate({opacity:1},"slow");var l=n.data("statistic_boxItem");r.text(U(j[l].heading,i)),o.text(U(j[l].subtext,i)),d.text(U(j[l].smallText,i))}}).fail(function(){throw new Error("Failed to load statistic resource.")})},V=function(t){var e,a,s,n,r,o;a=$("<i>"),a.addClass("fa fa-fw fa-lg").addClass(t.data("statistic_boxIcon")),e=$("<div>"),e.addClass("icon-container span4").addClass(t.data("statistic_boxColor")).append(a),n=$("<div>"),n.addClass("heading"),r=$("<div>"),r.addClass("subtext"),o=$("<div>"),o.addClass("small-text"),s=$("<div>"),s.addClass("text-container span8").append(n).append(r).append(o),t.on("click",function(t){j[$(this).data("statistic_boxItem")].onClick(t)}),t.addClass("toolbar grid").append(e).append(s)};return o.init=function(t){a.each(function(t,e){V($(e))}),e.on("get:data",function(t,e){e&&N(e)}),t()},o});