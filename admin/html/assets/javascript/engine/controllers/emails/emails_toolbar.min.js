"use strict";gx.controllers.module("emails_toolbar",[gx.source+"/libs/emails","url_arguments"],function(e){var t=$(this),n=$("#emails-modal"),i=$("#emails-table"),l={},s=($.extend(!0,{},l,e),{model:{settings:jse.core.config.get("appUrl")+"/admin/admin.php?do=Emails/GetEmailSettings"}}),a=function(e){if(jse.libs.emails.resetModal(n),"undefined"!=typeof s.model.settings&&null!==s.model.settings){if(null!==s.model.settings.signature&&""!==s.model.settings.signature){var t="<br><p>-----<br>"+s.model.settings.signature.replace("\n/g","<br>")+"</p>";CKEDITOR.instances["content-html"].setData(t);var l="\n\n-----\n"+s.model.settings.signature.replace(/(<([^>]+)>)/gi,"");n.find("#content-plain").val(l)}s.model.settings.useHtml===!1&&(n.find(".content").find(".tab-headline:eq(0), .tab-content:eq(0)").hide(),n.find(".content").find(".tab-headline:eq(1)").trigger("click")),"undefined"!=typeof s.model.settings.replyAddress&&""!==s.model.settings.replyAddress&&n.find("#sender-email, #reply-to-email").val(s.model.settings.replyAddress),"undefined"!=typeof s.model.settings.replyName&&""!==s.model.settings.replyName&&n.find("#sender-name, #reply-to-name").val(s.model.settings.replyName)}n.dialog({title:jse.core.lang.translate("new_mail","buttons"),width:1e3,height:740,modal:!1,dialogClass:"gx-container",closeOnEscape:!1,buttons:jse.libs.emails.getDefaultModalButtons(n,i),open:jse.libs.emails.colorizeButtonsForEditMode})},o=function(e){e.preventDefault();var n=t.find("#search-keyword").val();i.DataTable().search(n).draw()};return s.init=function(e){t.find("#bulk-action").val(""),t.on("click","#create-new-email",a).on("submit","#quick-search",o);var i=jse.libs.url_arguments.getUrlParameters();"undefined"!=typeof i.mailto&&(a({}),n.find("#recipient-email").val(i.mailto)),e()},s});