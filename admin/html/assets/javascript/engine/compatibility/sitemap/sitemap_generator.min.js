"use strict";gx.compatibility.module("sitemap_generator",[gx.source+"/libs/info_messages","loading_spinner"],function(e){var r,n=$(this),o={url:"gm_sitemap_creator.php"},t=$.extend(!0,{},o,e),a=jse.libs.info_messages,i={},s=function(){$.ajax({url:t.url,data:t.params}).done(function(e){a.addSuccess(e),jse.libs.loading_spinner.hide(r)}).fail(function(e){jse.core.debug.error("Prepare Content Error: ",e)})},c=function p(e){return e=e||$.Deferred(),$.ajax({url:t.url,data:{action:"prepare_categories",page_token:jse.core.config.get("pageToken")},dataType:"json"}).done(function(r){r.repeat===!0?p(e):e.resolve()}).fail(function(r){jse.core.debug.error("Prepare Categories Error: ",r),e.reject()}),e.promise()},u=function l(e){return e=e||$.Deferred(),$.ajax({url:t.url,data:{action:"prepare_content",page_token:jse.core.config.get("pageToken")},dataType:"json"}).done(function(r){r.repeat===!0?l(e):e.resolve()}).fail(function(r){jse.core.debug.error("Prepare Content Error: ",r),e.reject()}),e.promise()};return i.init=function(e){n.on("click",function(){return r=jse.libs.loading_spinner.show(n.parents().eq(2)),$.when(c(),u()).done(s),n.blur(),!1}),e()},i});