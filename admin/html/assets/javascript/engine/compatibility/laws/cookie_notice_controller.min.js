"use strict";gx.compatibility.module("cookie_notice_controller",["loading_spinner"],function(e){var a=$(this),n={model:{formData:jse.core.config.get("appUrl")+"/admin/admin.php?do=Laws/GetCookiePreferences&pageToken="+jse.core.config.get("pageToken")}},t=function(e,a){var n=$("<div/>"),t=$(".message_stack_container");n.addClass("alert alert-"+a).text(e).appendTo(".message_stack_container"),t.removeClass("hidden"),setTimeout(function(){n.remove(),t.addClass("hidden")},5e3)};return n.init=function(e){a.on("submit",function(e){e.preventDefault();var i,o=jse.core.config.get("appUrl")+"/admin/admin.php?do=Laws/SaveCookiePreferences",s=$.extend({pageToken:jse.core.config.get("pageToken")},n.model.formData);$.ajax({url:o,type:"POST",data:s,dataType:"json",beforeSend:function(){i=jse.libs.loading_spinner.show(a)}}).done(function(){t(jse.core.lang.translate("TXT_SAVE_SUCCESS","admin_general"),"success")}).fail(function(e,a,n){t(jse.core.lang.translate("TXT_SAVE_ERROR","admin_general"),"danger"),jse.core.debug.error("Could not save Cookie Notice preferences:",e,a,n)}).always(function(){jse.libs.loading_spinner.hide(i),$("html, body").animate({scrollTop:0})})}),$(".languages").on("click","a",function(e){e.preventDefault(),$(this).siblings().removeClass("active"),$(this).addClass("active"),$.each(n.model.formData,function(e,n){var t=a.find('[name="'+e+'"]');if(void 0!==t.data("multilanguage")){var i=$(".languages a.active").data("code");t.val(n[i]),t.is("textarea")&&CKEDITOR.instances[e].setData(n[i])}else t.val(n),t.is(":checkbox")&&"true"===n&&(t.parent().addClass("checked"),t.prop("checked",!0)),"position"!==e||n||t.find('option[value="top"]').prop("selected",!0).trigger("change")})}),a.on("change","input:hidden, input:text, select, textarea",function(){if(void 0!==$(this).data("multilanguage")){var e=$(".languages a.active").data("code");n.model.formData[$(this).attr("name")][e]=$(this).val()}else n.model.formData[$(this).attr("name")]=$(this).val()}),a.on("click",".switcher",function(){n.model.formData[$(this).find("input:checkbox").attr("name")]=$(this).hasClass("checked")});for(var i in CKEDITOR.instances)CKEDITOR.instances[i].on("change",function(){CKEDITOR.instances[i].updateElement(),$('[name="'+i+'"]').trigger("change")});$(".languages").find(".active").click(),a.find(".color-preview").each(function(){$(this).css("background-color",$(this).siblings("input:hidden").val())}),e()},n});