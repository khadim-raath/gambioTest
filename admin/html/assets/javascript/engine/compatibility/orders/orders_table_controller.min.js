"use strict";gx.compatibility.module("orders_table_controller",[gx.source+"/libs/action_mapper",gx.source+"/libs/button_dropdown"],function(t){var e=($(this),{}),n=($.extend(!0,{},e,t),[]),o=(jse.libs.action_mapper,{}),r=function(){var t=$('tr[data-row-id] input[type="checkbox"]:checked');$(".js-bottom-dropdown button").prop("disabled",!t.length)},a=function(t){var e=t.find(".js-button-dropdown");e.length&&T(e)},T=function(t){var e=["TEXT_SHOW","TEXT_GM_STATUS","delete","BUTTON_GM_CANCEL","TITLE_INVOICE","TITLE_INVOICE_MAIL","TITLE_PACKINGSLIP","TITLE_ORDER","TITLE_RECREATE_ORDER","TITLE_SEND_ORDER","TEXT_CREATE_WITHDRAWAL","TXT_PARCEL_TRACKING_SENDBUTTON_TITLE","BUTTON_DHL_LABEL","MAILBEEZ_OVERVIEW","MAILBEEZ_NOTIFICATIONS","MAILBEEZ_CONVERSATIONS","BUTTON_HERMES"];for(var n in e)m(t,e[n],".single-order-dropdown")},_={TEXT_SHOW:"orders",TEXT_GM_STATUS:"orders","delete":"buttons",BUTTON_GM_CANCEL:"orders",TITLE_INVOICE:"orders",TITLE_INVOICE_MAIL:"orders",TITLE_PACKINGSLIP:"orders",TITLE_ORDER:"orders",TITLE_RECREATE_ORDER:"orders",TITLE_SEND_ORDER:"orders",TEXT_CREATE_WITHDRAWAL:"orders",TXT_PARCEL_TRACKING_SENDBUTTON_TITLE:"parcel_services",BUTTON_DHL_LABEL:"orders",MAILBEEZ_OVERVIEW:"orders",MAILBEEZ_NOTIFICATIONS:"orders",MAILBEEZ_CONVERSATIONS:"orders",BUTTON_MULTI_CANCEL:"orders",BUTTON_MULTI_CHANGE_ORDER_STATUS:"orders",BUTTON_MULTI_DELETE:"orders",BUTTON_HERMES:"orders",get_labels:"iloxx"},i={TEXT_SHOW:".contentTable .infoBoxContent a.btn-details",TEXT_GM_STATUS:".contentTable .infoBoxContent a.btn-update_order_status","delete":".contentTable .infoBoxContent a.btn-delete",BUTTON_GM_CANCEL:".contentTable .infoBoxContent .GM_CANCEL",TITLE_INVOICE:".contentTable .infoBoxContent a.btn-invoice",TITLE_INVOICE_MAIL:".contentTable .infoBoxContent .GM_INVOICE_MAIL",TITLE_PACKINGSLIP:".contentTable .infoBoxContent a.btn-packing_slip",TITLE_ORDER:".contentTable .infoBoxContent a.btn-order_confirmation",TITLE_RECREATE_ORDER:".contentTable .infoBoxContent a.btn-recreate_order_confirmation",TITLE_SEND_ORDER:".contentTable .infoBoxContent .GM_SEND_ORDER",TEXT_CREATE_WITHDRAWAL:".contentTable .infoBoxContent a.btn-create_withdrawal",TXT_PARCEL_TRACKING_SENDBUTTON_TITLE:".contentTable .infoBoxContent a.btn-add_tracking_code",BUTTON_DHL_LABEL:".contentTable .infoBoxContent a.btn-dhl_label",MAILBEEZ_OVERVIEW:".contentTable .infoBoxContent a.context_view_button.btn_left",MAILBEEZ_NOTIFICATIONS:".contentTable .infoBoxContent a.context_view_button.btn_middle",MAILBEEZ_CONVERSATIONS:".contentTable .infoBoxContent a.context_view_button.btn_right",BUTTON_MULTI_CANCEL:".contentTable .infoBoxContent a.btn-multi_cancel",BUTTON_MULTI_CHANGE_ORDER_STATUS:".contentTable .infoBoxContent a.btn-update_order_status",BUTTON_MULTI_DELETE:".contentTable .infoBoxContent a.btn-multi_delete",BUTTON_HERMES:".contentTable .infoBoxContent a.btn-hermes",get_labels:"#iloxx_orders"},c=function(t){switch(t){case"TEXT_SHOW":return E;case"TEXT_GM_STATUS":return d;case"delete":return s;case"BUTTON_GM_CANCEL":return I;case"TITLE_INVOICE":return l;case"TITLE_INVOICE_MAIL":return u;case"TITLE_PACKINGSLIP":return L;case"TITLE_ORDER":return b;case"TITLE_RECREATE_ORDER":return N;case"TITLE_SEND_ORDER":return p;case"TEXT_CREATE_WITHDRAWAL":return A;case"TXT_PARCEL_TRACKING_SENDBUTTON_TITLE":return C;case"BUTTON_DHL_LABEL":return O;case"MAILBEEZ_OVERVIEW":return f;case"MAILBEEZ_NOTIFICATIONS":return R;case"MAILBEEZ_CONVERSATIONS":return B;case"BUTTON_MULTI_CANCEL":return U;case"BUTTON_MULTI_CHANGE_ORDER_STATUS":return h;case"BUTTON_MULTI_DELETE":return S;case"BUTTON_HERMES":return g;case"get_labels":return D}},E=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i.TEXT_SHOW).attr("href");window.open(n.replace(/oID=(.*)&/,"oID="+e+"&"),"_self")},d=function(t){var e=$(t.target).parents("tr").data("row-id");$("#gm_order_id").val(e),$(".gx-orders-table .single-checkbox").removeClass("checked"),$(".gx-orders-table input:checkbox").prop("checked",!1),$(t.target).parents("tr").eq(0).find(".single-checkbox").addClass("checked"),$(t.target).parents("tr").eq(0).find("input:checkbox").prop("checked",!0),$(i.TEXT_GM_STATUS).click()},s=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i["delete"]);n.data("order_id",e),n.get(0).click()},I=function(t){var e=$(t.target).parents("tr").data("row-id");$("#gm_order_id").val(e),$(".gx-orders-table .single-checkbox").removeClass("checked"),$(".gx-orders-table input:checkbox").prop("checked",!1),$(t.target).parents("tr").eq(0).find(".single-checkbox").addClass("checked"),$(t.target).parents("tr").eq(0).find("input:checkbox").prop("checked",!0),$(i.BUTTON_MULTI_CANCEL).click()},l=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i.TITLE_INVOICE).attr("href");window.open(n.replace(/oID=(.*)&/,"oID="+e+"&"),"_blank")},u=function(t){var e=$(t.target).parents("tr").data("row-id");$("#gm_order_id").val(e),$(".GM_INVOICE_MAIL").click()},L=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i.TITLE_PACKINGSLIP).attr("href");window.open(n.replace(/oID=(.*)&/,"oID="+e+"&"),"_blank")},b=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i.TITLE_ORDER).attr("href");window.open(n.replace(/oID=(.*)&/,"oID="+e+"&"),"_blank")},N=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i.TITLE_RECREATE_ORDER).attr("href");window.open(n.replace(/oID=(.*)&/,"oID="+e+"&"),"_blank")},p=function(t){var e=$(t.target).parents("tr").data("row-id");$("#gm_order_id").val(e),$(".GM_SEND_ORDER").click()},A=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i.TEXT_CREATE_WITHDRAWAL).attr("href");window.open(n.replace(/order=[^&]*/,"order_id="+e),"_blank")},C=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i.TXT_PARCEL_TRACKING_SENDBUTTON_TITLE);n.data("order_id",e),n.get(0).click()},O=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i.BUTTON_DHL_LABEL).attr("href");window.open(n.replace(/oID=(.*)/,"oID="+e),"_blank")},f=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i.MAILBEEZ_OVERVIEW),o=n.attr("onclick");o=o.replace(/oID=(.*)&/,"oID="+e+"&"),n.attr("onclick",o),n.get(0).click()},R=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i.MAILBEEZ_NOTIFICATIONS),o=n.attr("onclick");o=o.replace(/oID=(.*)&/,"oID="+e+"&"),n.attr("onclick",o),n.get(0).click()},B=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i.MAILBEEZ_CONVERSATIONS),o=n.attr("onclick");o=o.replace(/oID=(.*)&/,"oID="+e+"&"),n.attr("onclick",o),n.get(0).click()},g=function(t){var e=$(t.target).parents("tr").data("row-id"),n=$(i.BUTTON_HERMES),o=n.attr("href");o=o.replace(/orders_id=(.*)/,"orders_id="+e),n.attr("href",o),n.get(0).click()},D=function(t){var e=$(i.get_labels);e.click()},h=function(t){$(i.BUTTON_MULTI_CHANGE_ORDER_STATUS).get(0).click()},S=function(t){$(i.BUTTON_MULTI_DELETE).get(0).click()},U=function(t){$(i.BUTTON_MULTI_CANCEL).get(0).click()},x=function(){var t=$("#orders-table-dropdown");m(t,"BUTTON_MULTI_CHANGE_ORDER_STATUS"),$(i.get_labels).length&&m(t,"get_labels"),m(t,"BUTTON_MULTI_DELETE"),m(t,"BUTTON_MULTI_CANCEL")},M=function(t){var e=[];$('.action_buttons .extended_single_actions a,.action_buttons .extended_single_actions button,.action_buttons .extended_single_actions input[type="button"],.action_buttons .extended_single_actions input[type="submit"]').each(function(){v($(this))||e.push($(this))});var o=t.data("row-id"),r=t.find(".js-button-dropdown");$.each(e,function(){var t=$(this),e=function(){void 0!==t.prop("href")&&t.prop("href",t.prop("href").replace(/oID=(.*)\d(?=&)?/,"oID="+o)),t.get(0).click()};jse.libs.button_dropdown.mapAction(r,t.text(),"",e),n.push(t)})},w=function(){var t=[];$('.action_buttons .extended_multi_actions a,.action_buttons .extended_multi_actions button,.action_buttons .extended_multi_actions input[type="button"],.action_buttons .extended_multi_actions input[type="submit"]').each(function(){v($(this))||t.push($(this))});var e=$("#orders-table-dropdown");$.each(t,function(){var t=$(this),o=function(){t.get(0).click()};jse.libs.button_dropdown.mapAction(e,t.text(),"",o),n.push(t)})},v=function(t){for(var e in n)if(t.is(n[e]))return!0;return!1},k=function(t){return void 0!==n[t]||void(n[t]=$(t))},m=function(t,e,n){var o=i[e],r=_[e],a=c(e),T=$(n).length?$(n):t;$(o).length&&(k(o),jse.libs.button_dropdown.mapAction(t,e,r,a,T))},G=function(){$('input.checkbox[name="gm_multi_status[]"]').add(".single-checkbox").add("a.action-icon").add(".js-button-dropdown").add("tr.dataTableRow a").on("click",function(t){t.stopPropagation(),r()})};return o.init=function(t){var e=setInterval(function(){if($(".js-button-dropdown").length){clearInterval(e),x(),w();var t=n;k(".contentTable .infoBoxContent a.context_view_button.btn_right"),$(".gx-orders-table tr").not(".dataTableHeadingRow").each(function(){n=[];for(var e in t)n[e]=t[e];a($(this)),M($(this))}),G(),r()}},300);r(),t()},o});