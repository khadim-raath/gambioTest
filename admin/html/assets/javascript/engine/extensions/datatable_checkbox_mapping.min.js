"use strict";gx.extensions.module("datatable_checkbox_mapping",[],function(e){function n(e){if(e.stopPropagation(),e.preventDefault(),k.hasClass("open"))return void k.removeClass("open");var n=$(e.target).offset(),t=k.find(".dropdown-menu");k.addClass("open"),t.offset({top:n.top+16,left:n.left}),t.css({bottom:"initial"}),l(t)&&t.offset({top:n.top-t.outerHeight(),left:n.left})}function t(){k.find(".dropdown-menu").css({top:"",left:"",bottom:""})}function o(){var e=b.parents("th");0===e.find("."+g.caretIconClass).length&&e.append('<i class="fa '+g.caretIconClass+'"></i>')}function c(){b.parents("th").find("."+g.caretIconClass).remove()}function i(e){$(e.target).parents("td").append('<i class="fa '+g.caretIconClass+'"></i>')}function a(e){$(e.target).parents("tr").find("."+g.caretIconClass).remove()}function s(){u.find("tr ."+g.caretIconClass).off("click").on("click",n)}function r(e){b.prop("checked",e),e?(b.parents(".single-checkbox").addClass("checked"),o(),s()):(b.parents(".single-checkbox").removeClass("checked"),c())}function l(e){var n=e.offset().top+e.outerHeight()+50,t=window.innerHeight+$(window).scrollTop();return n>t}function f(){var e=u.find(g.rowSelection);e.on("change",function(n){k.removeClass("open"),$(n.target).prop("checked")?(i(n),s()):a(n),r(0===e.not(":checked").length)})}function d(e){0!==b.parents(".single-checkbox").length&&(b.prop("checked")?(o(),s()):c(e))}function p(){t()}var u=$(this),h={bulkAction:".bulk-action",bulkSelection:".bulk-selection",caretIconClass:"fa-caret-down",rowSelection:"tbody tr input:checkbox"},g=$.extend(!0,{},h,e),k=$(g.bulkAction),b=u.find(g.bulkSelection).last(),C={};return C.init=function(e){u.on("single_checkbox:ready",f),b.on("change",d),k.find(".dropdown-toggle").on("click",p),e()},C});