"use strict";gx.extensions.module("gmotion",[],function(t){var n=$(this),o=(Boolean(t.isPrimaryImage),{activator:"[data-gmotion-activator]",useCheckbox:"[data-gmotion-checkbox]",settingsContainer:"[data-gmotion-settings-container]",startDragger:"[data-gmotion-start-dragger]",endDragger:"[data-gmotion-end-dragger]",playgroundImage:"[data-gmotion-image]",startInput:"[data-gmotion-start-input]",endInput:"[data-gmotion-end-input]",zoomFromInput:"[data-gmotion-zoomstart-input]",zoomToInput:"[data-gmotion-zoomto-input]",durationInput:"[data-gmotion-duration-input]",sortInput:"[data-gmotion-sort-input]",settingRows:".gmotion-setting"}),i={animationStartLeft:0,animationStartTop:50,animationEndLeft:100,animationEndTop:50,zoomStart:1,zoomEnd:1,animationDuration:10,draggerWidth:12,draggerHeight:14},a={},r=function(t,i,a){var r=n.find(o.startDragger),e=n.find(o.startInput),d=n.find(o.endInput),g=r.is(t)?e:d,u=[i+"%",a+"%"].join(" ");g.val(u)},e=function(t){var i=n.find(o.startDragger),a=n.find(o.endDragger),r=n.find(o.startInput),e=$(t).val(),d=m(e),u=null===d||d[0]>100||d[1]>100;if(!u){var c=s(d[0],d[1]),f=r.is(t)?i:a;g(f,c)}},d=function(){var t=n.find(o.playgroundImage),i=n.find(o.startDragger),a=n.find(o.endDragger),e={containment:t,drag:function(){var t=u($(this).css("left").replace("px",""),$(this).css("top").replace("px",""));r(this,t.left,t.top)}};i.draggable(e),a.draggable(e)},g=function(t,n){$(t).css(n)},u=function(t,a){var r=n.find(o.playgroundImage),e={left:null,top:null},d=r.width()-i.draggerWidth,g=t/d*100;e.left=Math.round(g);var u=r.height()-i.draggerHeight,s=a/u*100;return e.top=Math.round(s),e},s=function(t,a){var r=n.find(o.playgroundImage),e={left:null,top:null},d=r.width()-i.draggerWidth;e.left=d/100*t;var g=r.height()-i.draggerHeight;return e.top=g/100*a,e},m=function(t){var n,o=/([\d]+)/g,i=t.match(o);return n=null===i||i.length<2?null:[i[0],i[1]]},c=function(t){var i=n.find(o.settingsContainer),a=n.find(o.settingRows);t?a.not(i).removeClass("hidden"):a.addClass("hidden")},f=function(t){var i=n.find(o.settingsContainer);n.find(o.settingRows);t?(i.removeClass("hidden").css({opacity:.1}),setTimeout(function(){d(),l(),i.animate({opacity:1})},1e3)):i.addClass("hidden"),i.find("input, select").prop("disabled",!t)},p=function(){var t=$(o.activator),i=n.find(o.useCheckbox),a=n.find(o.startInput),r=n.find(o.endInput);t.parent().on("click",function(){c(t.is(":checked")),f(i.is(":checked")&&t.is(":checked"))}),i.parent().on("click",function(){f(i.is(":checked"))}),a.on("keyup",function(){e(this)}),r.on("keyup",function(){e(this)})},l=function(){var a=(n.find(o.playgroundImage),n.find(o.startInput)),d=n.find(o.endInput),g=n.find(o.zoomFromInput),u=n.find(o.zoomToInput),s=n.find(o.durationInput);t.positionFrom?a.val(t.positionFrom):r(a,i.animationStartLeft,i.animationStartTop),e(a),t.positionTo?d.val(t.positionTo):r(d,i.animationEndLeft,i.animationEndTop),e(d);var m=t.zoomFrom?t.zoomFrom:i.zoomStart;g.val(m);var c=t.zoomTo?t.zoomTo:i.zoomEnd;u.val(c);var f=t.duration?t.duration:i.animationDuration;s.val(f)},h=function(){var t=$(o.activator),i=n.find(o.useCheckbox);t.is(":checked")&&(c(!0),i.is(":checked")&&f(!0))};return a.init=function(t){h(),p(),t()},a});