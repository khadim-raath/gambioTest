function reset(){$.ajax({type:"GET",url:"request_port.php?module=DBBackup&action=reset_db_backup&page_token="+jse.core.config.get("pageToken"),timeout:3e4,context:this,success:function(e){create_backup()},error:function(e,t){reset()}})}function create_backup(){$.ajax({type:"GET",url:"request_port.php?module=DBBackup&action=create_db_backup&page_token="+jse.core.config.get("pageToken"),timeout:3e4,context:this,success:function(e){if("object"!=$.type(e)||"continue_backup"!=e.status&&"backup_done"!=e.status)if("object"==$.type(e)){var t=e.error_message;""==$.trim(t)&&(t="Unbekannter Fehler!"),reset_backup(t)}else reset_backup(e);else $(".progress_text",t_lightbox_package).html(e.progress+"%"),$(".progress_job",t_lightbox_package).html(e.job),$(".progress_marker",t_lightbox_package).width(e.progress+"%"),"continue_backup"==e.status?create_backup():"backup_done"==e.status&&bundle_backup("zip")},error:function(e,t){reset_backup("Unbekannter Fehler!")}})}function bundle_backup(e){var t=$.trim(e);$.ajax({type:"GET",url:"request_port.php?module=DBBackup&action=bundle_db_backup&bundle_type="+t+"&page_token="+jse.core.config.get("pageToken"),timeout:3e4,context:this,success:function(e){"object"!=$.type(e)||"error"==e.status?"zip"==t?($(".progress_marker",t_lightbox_package).width("97%"),$(".progress_text",t_lightbox_package).html("97%"),bundle_backup("gzip")):"gzip"==t?($(".progress_marker",t_lightbox_package).width("98%"),$(".progress_text",t_lightbox_package).html("98%"),bundle_backup("sql")):"sql"==t&&"object"!=$.type(e)?reset_backup(e):"sql"==t&&"object"==$.type(e)&&reset_backup(e.error_message):"success"==e.status&&($(".progress_marker",t_lightbox_package).width("99%"),$(".progress_text",t_lightbox_package).html("99%"),$(".progress_job",t_lightbox_package).html(e.job),reset_backup())},error:function(e,t){reset_backup("Unbekannter Fehler!")}})}function reset_backup(e){var t=!1;""!=$.trim(e)&&"false"!=$.trim(e)&&(t=$.trim(e)),$.ajax({type:"GET",url:"request_port.php?module=DBBackup&action=reset_db_backup&page_token="+jse.core.config.get("pageToken"),timeout:3e4,context:this,success:function(e){0==t?($(".progress_job",t_lightbox_package).html(e.job),$("#db_backup_wrapper").html(e.html),$(".progress_marker",t_lightbox_package).width("100%"),$(".progress_text",t_lightbox_package).html("100%")):($(".db_backup_lightbox_error_message",t_lightbox_package).html(t).show(),$(".db_backup_lightbox_process",t_lightbox_package).hide()),$(".button_right_container .lightbox_close",t_lightbox_package).show()},error:function(e,o){reset_backup(t)}})}$(".confirm_db_backup_create",t_lightbox_package).bind("click",function(){return!$(this).hasClass("active")&&($(this).addClass("active").hide(),$(".button_left_container .lightbox_close",t_lightbox_package).hide(),$(".db_backup_lightbox_process",t_lightbox_package).css("visibility","visible"),void reset())}),$(".lightbox_close",t_lightbox_package).live("click",function(){return $.lightbox_plugin("close",t_lightbox_identifier),!1});