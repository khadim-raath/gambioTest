!function(o){o.fn.google_categories_administration=function(t){function e(){o.ajax({type:"GET",url:"request_port.php?module=GoogleTaxonomy",data:{action:"get_template",template:"google_categories_administration.html"},success:function(t){o(".google_categories_administration").append(t),a()}})}function a(){var t=o(".google_categories_administration").attr("id").replace("product_id_","");o.ajax({type:"GET",url:"request_port.php?module=GoogleTaxonomy",data:{action:"get_product_google_category_array",product_id:t},success:function(t){t=o.parseJSON(t),t.length>0&&o(".google_category_list_add_button a").hide(),o.each(t,function(t,e){o(".google_category_list span").show();var a=o("<input></input>").attr("name","category_list[]["+e.v_products_google_categories_id+"]").addClass("category_list").attr("type","text").attr("readonly","readonly").val(e.v_google_category),_=o("<i></i>").addClass("fa fa-pencil fa-lg fa-fw"),g=o("<a></a>").attr("href","#").addClass("edit btn-edit").append(_);o(".google_category_list").prepend(g).prepend(a),o(".google_category_list").find(".delete-checkbox").val(e.v_products_google_categories_id)})}})}function _(){o(".google_category_list_add_box .category_string").empty(),o.each(o(".google_category_list_add_box select"),function(t,e){if(0!=t){if(""!=o(e).val()){var a=o(".google_category_list_add_box .category_string").val();a=a+" > "+o(e).val(),o(".google_category_list_add_box .category_string").val(a)}}else o(".google_category_list_add_box .category_string").val(o(e).val())})}function g(t){""==t?o(".google_category_list_add_box").addClass("add"):o(".google_category_list_add_box").addClass("edit"),o(".google_category_list_add_box .category_string").val(t),i("",t),o(".google_category_list_add_box").show()}function l(t,e){if(0!=e){var a=new Array;""!=o.trim(o(".google_category_list_add_box .category_string").val())&&(a=o(".google_category_list_add_box .category_string").val().split(">"),o.each(a,function(t,e){a[t]=o.trim(e)}));var _=o("<select></select>");_.append(o("<option></option>").attr("value","").html(o(".text.select").val())),o.each(e,function(e,g){g=o.trim(g),""!=g&&(o.inArray(g,a)!=-1&&a.length>0&&o(".google_category_list_add_box").hasClass("edit")?(t=o.trim(t),o(".google_category_list_add_box").append(d),i(""!=t?t+" > "+g:g),_.append(o("<option></option>").attr("value",g).html(g).attr("selected","selected"))):_.append(o("<option></option>").attr("value",g).html(g)))});var g=o("<div></div>").addClass("category_select_container").append(_);o(".google_category_select_boxes").append(g)}}function i(t){o.ajax({type:"GET",url:"request_port.php?module=GoogleTaxonomy",data:{action:"get_google_categories_array",parent:t},success:function(e){e=o.parseJSON(e),l(t,e),o(d).remove()},error:function(){o(d).remove()}})}var r=o("<img></img>").attr("src","../images/loading.gif"),d=o("<div></div>").addClass("loading_image_box").append(r),s=o(this).attr("id").split("_");return"product"==s[0]&&(e(),o(".google_category_list_add_button a").live("click",function(){return o(".google_category_list_add_box").append(d),o(".google_category_list_add_button a").hide(),g(""),!1}),o(".google_category_list .edit").live("click",function(){o(".google_category_list input").removeClass("edit"),o(this).prev().addClass("edit");var t=o(this).prev().val();return o(".google_category_list_add_box").append(d),g(t),o(".google_category_list_add_button a").hide(),o(".google_category_list_add_box div.category_select_container").remove(),!1}),o(".google_category_list_add_box .add").live("click",function(){o(".google_category_list_add_button a").hide();var t=!1;if(o.each(o(".google_category_list input"),function(e,a){o(a).val()==o(".google_category_list_add_box .category_string").val()&&(t=!0)}),""!=o(".google_category_list_add_box .category_string").val()&&0==t){if(o(".google_category_list_add_box").hasClass("edit"))o(".google_category_list input.edit").val(o(".google_category_list_add_box .category_string").val()),o(".google_category_list input").removeClass("edit");else{var e=o("<input></input>").attr("name","category_list[][0]").addClass("category_list").attr("type","text").attr("readonly","readonly").val(o(".google_category_list_add_box .category_string").val()),a=o("<i></i>").addClass("fa fa-pencil fa-lg fa-fw"),_=o("<a></a>").attr("href","#").addClass("edit btn-edit").append(a);o(".google_category_list").find(".delete-checkbox").val(0),o(".google_category_list").prepend(_).prepend(e),o(".google_category_list span").show()}0==o('.google_category_list input[name^="category_list"]').length&&o(".google_category_list_add_button a").show(),o(".google_category_list_add_box").hide(),o(".google_category_list_add_box").removeClass("add edit"),o(".google_category_list_add_box div.category_select_container").remove()}return!1}),o(".google_category_list_add_box .cancel").live("click",function(){return 0==o('.google_category_list input[name^="category_list"]').length&&o(".google_category_list_add_button a").show(),o(".google_category_list_add_box").hide(),o(".google_category_list_add_box").removeClass("add edit"),o(".google_category_list_add_box div.category_select_container").remove(),o(".google_category_list input").removeClass("edit"),!1}),o(".google_category_list_add_box select").live("change",function(){var t=o(this).parent().nextAll().find("select");o.each(t,function(t,e){o(e).remove()}),_(),""!=o(this).val()&&(o(".google_category_list_add_box").append(d),i(o(".google_category_list_add_box .category_string").val()))})),!1}}(jQuery),$(document).ready(function(){1==$("div.google_categories_administration").length&&$("div.google_categories_administration").google_categories_administration()});