function calSwapImg(whatID,NewImg,override){return document.images&&(IsCalendarVisible&&override||(document.images[whatID].src=eval(NewImg+".src"))),window.status=" ",!0}function getOffsetLeft(e){for(var a=e.offsetLeft;null!=(e=e.offsetParent);)a+=e.offsetLeft;return a+130}function getOffsetTop(e){for(var a=e.offsetTop;null!=(e=e.offsetParent);)a+=e.offsetTop;return a-50}function showCalendar(e,a,t,l,n,r,c,o,s,i,m){hideDropDowns=l,FuncsToRun=m,calfrmName=e,IsCalendarVisible?hideCalendar():(null!=document.images.calbtn1&&(document.images.calbtn1.src=img_del.src),null!=document.images.calbtn2&&(document.images.calbtn2.src=img_close.src),hideDropDowns&&toggleDropDowns("hidden"),null!=n&&null!=r&&null!=c&&null!=o&&null!=s&&null!=i?(IsUsingMinMax=!0,minDate.setDate(n),minDate.setMonth(r-1),minDate.setFullYear(c),maxDate.setDate(o),maxDate.setMonth(s-1),maxDate.setFullYear(i)):IsUsingMinMax=!1,curImg=t,curDateBox=a,ppcIE?(ppcX=getOffsetLeft(document.images[t]),ppcY=getOffsetTop(document.images[t])+document.images[t].height):ppcNN&&(ppcX=document.images[t].x+90,ppcY=document.images[t].y-45),domlay("popupcalendar",1,ppcX,ppcY,Calendar(todayDate.getMonth(),todayDate.getFullYear())),IsCalendarVisible=!0)}function toggleDropDowns(e){var a,t;for(a=0;a<document.forms.length;a++)for(t=0;t<document.forms[a].elements.length;t++)"SELECT"==document.forms[a].elements[t].tagName&&"Cal"!=document.forms[a].name&&(document.forms[a].elements[t].style.visibility=e)}function hideCalendar(){domlay("popupcalendar",0,ppcX,ppcY),calSwapImg(curImg,"img_Date_UP"),IsCalendarVisible=!1,hideDropDowns&&toggleDropDowns("visible")}function calClick(){window.focus()}function domlay(e,a,t,l,n){if("1"==a?document.layers?document.layers[""+e].visibility="show":document.all?document.all[""+e].style.visibility="visible":document.getElementById&&(document.getElementById(""+e).style.visibility="visible"):"0"==a&&(document.layers?document.layers[""+e].visibility="hide":document.all?document.all[""+e].style.visibility="hidden":document.getElementById&&(document.getElementById(""+e).style.visibility="hidden")),t&&(document.layers?document.layers[""+e].left=t:document.all?document.all[""+e].style.left=t:document.getElementById&&(document.getElementById(""+e).style.left=t+"px")),l&&(document.layers?document.layers[""+e].top=l:document.all?document.all[""+e].style.top=l:document.getElementById&&(document.getElementById(""+e).style.top=l+"px")),n)if(document.layers)sprite=document.layers[""+e].document,sprite.open(),sprite.write(n),sprite.close();else if(document.all)document.all[""+e].innerHTML=n;else if(document.getElementById){for(rng=document.createRange(),el=document.getElementById(""+e),rng.setStartBefore(el),htmlFrag=rng.createContextualFragment(n);el.hasChildNodes();)el.removeChild(el.lastChild);el.appendChild(htmlFrag)}}function Calendar(e,a){var t,l,n,r="";for(l=e,n=a,curDate.setMonth(e),curDate.setFullYear(a),curDate.setDate(todayDate.getDate()),r+=ppcNN6?'<form name="Cal"><table width="185" border="3" class="cal-Table" cellspacing="0" cellpadding="0"><tr>':'<table width="185" border="3" class="cal-Table" cellspacing="0" cellpadding="0"><form name="Cal"><tr>',r+='<td class="cal-HeadCell" align="center" width="100%"><a href="javascript:clearDay();"><img name="calbtn1" src="./html/assets/images/legacy/cal_del_small.gif" border="0" width="12" height="10"></a>&nbsp;&nbsp;<a href="javascript:scrollMonth(-1);" class="cal-DayLink">&lt;</a>&nbsp;<SELECT class="cal-TextBox" NAME="cboMonth" onChange="changeMonth();">',month=0;month<12;month++)r+=month==e?'<OPTION VALUE="'+month+'" SELECTED>'+names[month]+"</OPTION>":'<OPTION VALUE="'+month+'">'+names[month]+"</OPTION>";for(r+='</SELECT><SELECT class="cal-TextBox" NAME="cboYear" onChange="changeYear();">',year=minYearList;year<maxYearList;year++)r+=year==a?'<OPTION VALUE="'+year+'" SELECTED>'+year+"</OPTION>":'<OPTION VALUE="'+year+'">'+year+"</OPTION>";for(r+='</SELECT>&nbsp;<a href="javascript:scrollMonth(1);" class="cal-DayLink">&gt;</a>&nbsp;&nbsp;<a href="javascript:hideCalendar();"><img name="calbtn2" src="./html/assets/images/legacy/cal_close_small.gif" border="0" width="12" height="10"></a></td></tr><tr><td width="100%" align="center">',firstDay=new Date(a,e,1),startDay=firstDay.getDay(),a%4==0&&a%100!=0||a%400==0?days[1]=29:days[1]=28,r+='<table width="185" cellspacing="1" cellpadding="2" border="0"><tr>',i=0;i<7;i++)t=0==i||6==i?"15%":"14%",r+='<td class="cal-HeadCell" width="'+t+'" align="center" valign="middle">'+dow[i]+"</td>";r+="</tr><tr>";var c=0,o=e-1,s=a;for(o==-1&&(o=11,s-=1),i=0;i<startDay;i++,c++)r+=getDayLink(days[o]-startDay+i+1,!0,o,s);for(i=1;i<=days[e];i++,c++)r+=getDayLink(i,!1,e,a),6==c&&(r+="</tr><tr>",c=-1);var m=e+1,d=a;if(12==m&&(m=0,d+=1),c>0){for(i=1;c<7;i++,c++)r+=getDayLink(i,!0,m,d);r+="</tr></table></td></tr>"}else r=r.substr(0,r.length-4),r+="</table></td></tr>";return r+=ppcNN6?"</table></form>":"</form></table>",curDate.setDate(1),curDate.setMonth(l),curDate.setFullYear(n),r}function getDayLink(e,a,t,l){var n;return n=IsUsingMinMax?isDayValid(e,t,l)?a?'<td align="center" class="cal-GreyDate">'+e+"</td>":isDayToday(e)?'<td align="center" class="cal-DayCell"><a class="cal-TodayLink" onmouseover="self.status=\' \';return true" href="javascript:changeDay('+e+');">'+e+"</a></td>":'<td align="center" class="cal-DayCell"><a class="cal-DayLink" onmouseover="self.status=\' \';return true" href="javascript:changeDay('+e+');">'+e+"</a></td>":'<td align="center" class="cal-GreyInvalidDate">'+e+"</td>":a?'<td align="center" class="cal-GreyDate">'+e+"</td>":isDayToday(e)?'<td align="center" class="cal-DayCell"><a class="cal-TodayLink" onmouseover="self.status=\' \';return true" href="javascript:changeDay('+e+');">'+e+"</a></td>":'<td align="center" class="cal-DayCell"><a class="cal-DayLink" onmouseover="self.status=\' \';return true" href="javascript:changeDay('+e+');">'+e+"</a></td>"}function isDayToday(e){return curDate.getFullYear()==todayDate.getFullYear()&&curDate.getMonth()==todayDate.getMonth()&&e==todayDate.getDate()}function isDayValid(e,a,t){return curDate.setDate(e),curDate.setMonth(a),curDate.setFullYear(t),curDate>=minDate&&curDate<=maxDate}function padout(e){return e<10?"0"+e:e}function clearDay(){eval("document."+calfrmName+".day.value = ''"),eval("document."+calfrmName+".month.value = ''"),eval("document."+calfrmName+".year.value = ''"),hideCalendar(),null!=FuncsToRun&&eval(FuncsToRun)}function changeDay(whatDay){curDate.setDate(whatDay),eval("document."+calfrmName+'.day.value = "'+padout(curDate.getDate())+'"'),eval("document."+calfrmName+'.month.value = "'+padout(curDate.getMonth()+1)+'"'),eval("document."+calfrmName+'.year.value = "'+curDate.getFullYear()+'"'),hideCalendar(),null!=FuncsToRun&&eval(FuncsToRun)}function scrollMonth(e){var a,t;ppcIE?a=document.forms.Cal.cboMonth.selectedIndex+e:ppcNN&&(a=document.popupcalendar.document.forms.Cal.cboMonth.selectedIndex+e),a<0?(t=curDate.getFullYear()-1,t<minYearList?(t=minYearList,a=0):a=11,curDate.setFullYear(t)):a>11&&(t=curDate.getFullYear()+1,t>maxYearList-1?(t=maxYearList-1,a=11):a=0,curDate.setFullYear(t)),ppcIE?curDate.setMonth(document.forms.Cal.cboMonth.options[a].value):ppcNN&&curDate.setMonth(document.popupcalendar.document.forms.Cal.cboMonth.options[a].value),domlay("popupcalendar",1,ppcX,ppcY,Calendar(curDate.getMonth(),curDate.getFullYear()))}function changeMonth(){ppcIE?(curDate.setMonth(document.forms.Cal.cboMonth.options[document.forms.Cal.cboMonth.selectedIndex].value),domlay("popupcalendar",1,ppcX,ppcY,Calendar(curDate.getMonth(),curDate.getFullYear()))):ppcNN&&(curDate.setMonth(document.popupcalendar.document.forms.Cal.cboMonth.options[document.popupcalendar.document.forms.Cal.cboMonth.selectedIndex].value),domlay("popupcalendar",1,ppcX,ppcY,Calendar(curDate.getMonth(),curDate.getFullYear())))}function changeYear(){ppcIE?(curDate.setFullYear(document.forms.Cal.cboYear.options[document.forms.Cal.cboYear.selectedIndex].value),domlay("popupcalendar",1,ppcX,ppcY,Calendar(curDate.getMonth(),curDate.getFullYear()))):ppcNN&&(curDate.setFullYear(document.popupcalendar.document.forms.Cal.cboYear.options[document.popupcalendar.document.forms.Cal.cboYear.selectedIndex].value),domlay("popupcalendar",1,ppcX,ppcY,Calendar(curDate.getMonth(),curDate.getFullYear())))}function makeArray0(){for(i=0;i<makeArray0.arguments.length;i++)this[i]=makeArray0.arguments[i]}var ppcIE="Microsoft Internet Explorer"==navigator.appName||"Netscape"==navigator.appName&&5==parseInt(navigator.appVersion),ppcNN6="Netscape"==navigator.appName&&5==parseInt(navigator.appVersion),ppcNN="Netscape"==navigator.appName&&document.layers,ppcX=4,ppcY=4,IsCalendarVisible,calfrmName,maxYearList,minYearList,todayDate=new Date,curDate=new Date,curImg,curDateBox,minDate=new Date,maxDate=new Date,hideDropDowns,IsUsingMinMax,FuncsToRun,img_del,img_close;img_del=new Image,img_del.src="./html/assets/images/legacy/cal_del_small.gif",img_close=new Image,img_close.src="./html/assets/images/legacy/cal_close_small.gif",minYearList=todayDate.getFullYear()-10,maxYearList=todayDate.getFullYear()+10,IsCalendarVisible=!1,img_Date_UP=new Image,img_Date_UP.src="./html/assets/images/legacy/cal_date_up.gif",img_Date_OVER=new Image,img_Date_OVER.src="./html/assets/images/legacy/cal_date_over.gif",img_Date_DOWN=new Image,img_Date_DOWN.src="./html/assets/images/legacy/cal_date_down.gif";var names=new makeArray0("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),days=new makeArray0(31,28,31,30,31,30,31,31,30,31,30,31),dow=new makeArray0("S","M","T","W","T","F","S");